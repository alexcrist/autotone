(()=>{var n={639:n=>{var e,t=(e="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(n){var t,r;(n=void 0!==(n=n||{})?n:{}).ready=new Promise((function(n,e){t=n,r=e}));var a=Object.assign({},n),o=[],i=(n,e)=>{throw e},u="";"undefined"!=typeof document&&document.currentScript&&(u=document.currentScript.src),e&&(u=e),u=0!==u.indexOf("blob:")?u.substr(0,u.replace(/[?#].*/,"").lastIndexOf("/")+1):"";var s,l=n.print||console.log.bind(console),c=n.printErr||console.warn.bind(console);Object.assign(n,a),a=null,n.arguments&&(o=n.arguments),n.thisProgram&&n.thisProgram,n.quit&&(i=n.quit),n.wasmBinary&&(s=n.wasmBinary);var f,p=n.noExitRuntime||!0;"object"!=typeof WebAssembly&&U("no native wasm support detected");var m,d,h,y,_,b,w,g,v=!1,A="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function T(n,e,t){for(var r=e+t,a=e;n[a]&&!(a>=r);)++a;if(a-e>16&&n.buffer&&A)return A.decode(n.subarray(e,a));for(var o="";e<a;){var i=n[e++];if(128&i){var u=63&n[e++];if(192!=(224&i)){var s=63&n[e++];if((i=224==(240&i)?(15&i)<<12|u<<6|s:(7&i)<<18|u<<12|s<<6|63&n[e++])<65536)o+=String.fromCharCode(i);else{var l=i-65536;o+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else o+=String.fromCharCode((31&i)<<6|u)}else o+=String.fromCharCode(i)}return o}function P(e){m=e,n.HEAP8=d=new Int8Array(e),n.HEAP16=y=new Int16Array(e),n.HEAP32=_=new Int32Array(e),n.HEAPU8=h=new Uint8Array(e),n.HEAPU16=new Uint16Array(e),n.HEAPU32=b=new Uint32Array(e),n.HEAPF32=w=new Float32Array(e),n.HEAPF64=g=new Float64Array(e)}n.INITIAL_MEMORY;var R,k,I,E,S=[],M=[],x=[],C=0,W=null,F=null;function U(e){n.onAbort&&n.onAbort(e),c(e="Aborted("+e+")"),v=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw r(t),t}function N(n){return n.startsWith("data:application/octet-stream;base64,")}function j(n){try{if(n==R&&s)return new Uint8Array(s);throw"both async and sync fetching of the wasm failed"}catch(n){U(n)}}function H(n){this.name="ExitStatus",this.message="Program terminated with exit("+n+")",this.status=n}function O(e){for(;e.length>0;)e.shift()(n)}function D(n){try{return f.grow(n-m.byteLength+65535>>>16),P(f.buffer),1}catch(n){}}N(R="tunerWasm.wasm")||(k=R,R=n.locateFile?n.locateFile(k,u):u+k);var B=[null,[],[]];function V(n,e){var t=B[n];0===e||10===e?((1===n?l:c)(T(t,0)),t.length=0):t.push(e)}function L(e){return n["_"+e]}function z(n,e,t,r,a){var o={string:n=>{var e=0;if(null!=n&&0!==n){var t=1+(n.length<<2);!function(n,e,t){!function(n,e,t,r){if(!(r>0))return 0;for(var a=t+r-1,o=0;o<n.length;++o){var i=n.charCodeAt(o);if(i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&n.charCodeAt(++o)),i<=127){if(t>=a)break;e[t++]=i}else if(i<=2047){if(t+1>=a)break;e[t++]=192|i>>6,e[t++]=128|63&i}else if(i<=65535){if(t+2>=a)break;e[t++]=224|i>>12,e[t++]=128|i>>6&63,e[t++]=128|63&i}else{if(t+3>=a)break;e[t++]=240|i>>18,e[t++]=128|i>>12&63,e[t++]=128|i>>6&63,e[t++]=128|63&i}}e[t]=0}(n,h,e,t)}(n,e=K(t),t)}return e},array:n=>{var e=K(n.length);return function(n,e){d.set(n,e)}(n,e),e}},i=L(n),u=[],s=0;if(r)for(var l=0;l<r.length;l++){var c=o[t[l]];c?(0===s&&(s=Y()),u[l]=c(r[l])):u[l]=r[l]}var f=i.apply(null,u);return function(n){return 0!==s&&J(s),function(n){return"string"===e?(t=n)?T(h,t,r):"":"boolean"===e?Boolean(n):n;var t,r}(n)}(f)}var q,G={emscripten_memcpy_big:function(n,e,t){h.copyWithin(n,e,e+t)},emscripten_resize_heap:function(n){var e,t=h.length,r=2147483648;if((n>>>=0)>r)return!1;for(var a=1;a<=4;a*=2){var o=t*(1+.2/a);if(o=Math.min(o,n+100663296),D(Math.min(r,(e=Math.max(n,o))+(65536-e%65536)%65536)))return!0}return!1},exit:function(e,t){var r;r=e,p||(n.onExit&&n.onExit(r),v=!0),i(r,new H(r))},fd_close:function(n){return 52},fd_seek:function(n,e,t,r,a){return 70},fd_write:function(n,e,t,r){for(var a=0,o=0;o<t;o++){var i=b[e>>2],u=b[e+4>>2];e+=8;for(var s=0;s<u;s++)V(n,h[i+s]);a+=u}return b[r>>2]=a,0}},Y=(function(){var e={env:G,wasi_snapshot_preview1:G};function t(e,t){var r,a=e.exports;n.asm=a,P((f=n.asm.memory).buffer),n.asm.__indirect_function_table,r=n.asm.__wasm_call_ctors,M.unshift(r),function(e){if(C--,n.monitorRunDependencies&&n.monitorRunDependencies(C),0==C&&(null!==W&&(clearInterval(W),W=null),F)){var t=F;F=null,t()}}()}function a(n){t(n.instance)}function o(n){return(s||"function"!=typeof fetch?Promise.resolve().then((function(){return j(R)})):fetch(R,{credentials:"same-origin"}).then((function(n){if(!n.ok)throw"failed to load wasm binary file at '"+R+"'";return n.arrayBuffer()})).catch((function(){return j(R)}))).then((function(n){return WebAssembly.instantiate(n,e)})).then((function(n){return n})).then(n,(function(n){c("failed to asynchronously prepare wasm: "+n),U(n)}))}if(C++,n.monitorRunDependencies&&n.monitorRunDependencies(C),n.instantiateWasm)try{return n.instantiateWasm(e,t)}catch(n){c("Module.instantiateWasm callback failed with error: "+n),r(n)}(s||"function"!=typeof WebAssembly.instantiateStreaming||N(R)||"function"!=typeof fetch?o(a):fetch(R,{credentials:"same-origin"}).then((function(n){return WebAssembly.instantiateStreaming(n,e).then(a,(function(n){return c("wasm streaming compile failed: "+n),c("falling back to ArrayBuffer instantiation"),o(a)}))}))).catch(r)}(),n.___wasm_call_ctors=function(){return(n.___wasm_call_ctors=n.asm.__wasm_call_ctors).apply(null,arguments)},n._upsample_linear=function(){return(n._upsample_linear=n.asm.upsample_linear).apply(null,arguments)},n._pitch_snap=function(){return(n._pitch_snap=n.asm.pitch_snap).apply(null,arguments)},n._pitch_shift=function(){return(n._pitch_shift=n.asm.pitch_shift).apply(null,arguments)},n._get_num_windows=function(){return(n._get_num_windows=n.asm.get_num_windows).apply(null,arguments)},n._free=function(){return(n._free=n.asm.free).apply(null,arguments)},n._malloc=function(){return(n._malloc=n.asm.malloc).apply(null,arguments)},n.___errno_location=function(){return(n.___errno_location=n.asm.__errno_location).apply(null,arguments)},n.stackSave=function(){return(Y=n.stackSave=n.asm.stackSave).apply(null,arguments)}),J=n.stackRestore=function(){return(J=n.stackRestore=n.asm.stackRestore).apply(null,arguments)},K=n.stackAlloc=function(){return(K=n.stackAlloc=n.asm.stackAlloc).apply(null,arguments)};function Q(e){function r(){q||(q=!0,n.calledRun=!0,v||(O(M),t(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),function(){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)e=n.postRun.shift(),x.unshift(e);var e;O(x)}()))}e=e||o,C>0||(function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)e=n.preRun.shift(),S.unshift(e);var e;O(S)}(),C>0||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),r()}),1)):r()))}if(n.dynCall_jiji=function(){return(n.dynCall_jiji=n.asm.dynCall_jiji).apply(null,arguments)},n.ccall=z,n.cwrap=function(n,e,t,r){var a=(t=t||[]).every((n=>"number"===n||"boolean"===n));return"string"!==e&&a&&!r?L(n):function(){return z(n,e,t,arguments)}},n.setValue=function(n,e,t="i8"){switch(t.endsWith("*")&&(t="*"),t){case"i1":case"i8":d[n>>0]=e;break;case"i16":y[n>>1]=e;break;case"i32":_[n>>2]=e;break;case"i64":E=[e>>>0,(I=e,+Math.abs(I)>=1?I>0?(0|Math.min(+Math.floor(I/4294967296),4294967295))>>>0:~~+Math.ceil((I-+(~~I>>>0))/4294967296)>>>0:0)],_[n>>2]=E[0],_[n+4>>2]=E[1];break;case"float":w[n>>2]=e;break;case"double":g[n>>3]=e;break;case"*":b[n>>2]=e;break;default:U("invalid type for setValue: "+t)}},n.getValue=function(n,e="i8"){switch(e.endsWith("*")&&(e="*"),e){case"i1":case"i8":return d[n>>0];case"i16":return y[n>>1];case"i32":case"i64":return _[n>>2];case"float":return w[n>>2];case"double":return g[n>>3];case"*":return b[n>>2];default:U("invalid type for getValue: "+e)}return null},F=function n(){q||Q(),q||(F=n)},n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return Q(),n.ready});n.exports=t}},e={};function t(r){var a=e[r];if(void 0!==a)return a.exports;var o=e[r]={exports:{}};return n[r](o,o.exports,t),o.exports}t.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return t.d(e,{a:e}),e},t.d=(n,e)=>{for(var r in e)t.o(e,r)&&!t.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:e[r]})},t.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),(()=>{"use strict";var n=t(639),e=t.n(n);const r=new class{_Module;async init(n){this._Module=await n()}cwrap(...n){return(...e)=>this._Module.ccall(...n,[...e])}int16ArrayToPointer(n){return this._arrayToPointer(n,2,"i16")}float32ArrayToPointer(n){return this._arrayToPointer(n,4,"float")}_arrayToPointer(n,e,t){const r=n.length*e,a=this._Module._malloc(r);for(let r=0;r<n.length;r++){const o=a+r*e;this._Module.setValue(o,n[r],t)}return{address:a,free:()=>this._Module._free(a)}}pointerToInt16Array(n,e){return this._pointerToArray(n,e,2,"i16",Int16Array)}pointerToFloat32Array(n,e){return this._pointerToArray(n,e,4,"float",Float32Array)}_pointerToArray(n,e,t,r,a){const o=new a(e);for(let a=0;a<e;a++)o[a]=this._Module.getValue(n+a*t,r);return o}},a=r.cwrap("get_num_windows","number",["number","number","number"]),o=r.cwrap("upsample_linear",null,["number","number","number","number"]),i=r.cwrap("pitch_snap",null,["number","number","number","number","number"]),u=r.cwrap("pitch_shift",null,["number","number","number","number","number","number","number","number","number","number","number"]);var s,l;self.onmessage=(s=self.postMessage,l=[{key:"TUNER_INIT",fn:async()=>{await r.init(e())}},{key:"TUNER_GET_NUM_WINDOWS",fn:(n,e,t)=>a(n,e,t)},{key:"TUNER_UPSAMPLE_LINEAR",fn:(n,e)=>{const t=r.float32ArrayToPointer(n),a=r.float32ArrayToPointer(new Float32Array(e));o(t.address,n.length,a.address,e);const i=r.pointerToFloat32Array(a.address,e);return t.free(),a.free(),i}},{key:"TUNER_PITCH_SNAP",fn:(n,e)=>{const t=r.float32ArrayToPointer(n),a=r.float32ArrayToPointer(e),o=r.float32ArrayToPointer(new Float32Array(n.length));i(t.address,n.length,a.address,e.length,o.address);const u=r.pointerToFloat32Array(o.address,n.length);return t.free(),a.free(),o.free(),u}},{key:"TUNER_PITCH_SHIFT",fn:(n,e,t,a,o,i,s=0)=>{const l=new Int16Array(n.length);for(let e=0;e<n.length;e++){const t=Math.max(-1,Math.min(1,n[e]));l[e]=t<0?32768*t:32767*t}const c=r.int16ArrayToPointer(l),f=r.float32ArrayToPointer(o),p=r.float32ArrayToPointer(i),m=r.int16ArrayToPointer(new Int16Array(n.length));u(c.address,n.length,t,e,a,f.address,o.length,p.address,i.length,s,m.address);const d=r.pointerToInt16Array(m.address,n.length);c.free(),f.free(),p.free(),m.free();const h=new Float32Array(n.length);for(let e=0;e<n.length;e++){const n=d[e];h[e]=n<0?n/32768:n/32767}return h}}],async n=>{const{type:e,payload:t}=n.data;for(const{key:n,fn:r}of l)if(n===e){const e=await r(...t);s({type:n,payload:e})}})})()})();